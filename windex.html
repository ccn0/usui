<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UserScript UI by CCN0</title>
    <style>
        body {
            margin:0;
            background-color: rgb(22, 31, 22);
        }
    </style>
    <script src="/usui/USUI.js"></script>
    <link rel="stylesheet" href="/usui/USUI.css">
</head>
<body>
    <noscript>this is a javascript library thing, you could probably guess why this is showing up</noscript>
    <script>
    openIFrame({url:"usui.html"});
    function openIFrame(params) {
        const oiContainer = USUI.createPopup({
            stay: false,
            id: "iframe",
            fencing: true,
            title: "UserScript UI",
            position: ["5%","5%"],
            buttons: [
                {
                    textContent: "X",
                    title: "Close",
                    event: () => {
                        USUIalert("Should run <code>USUI.closeMenu(popup);</code>, but you <em>can</em> close this popup!", {usehtml: true, titletext: "Closeable"})
                    },
                },
                {
                    textContent: "Modules",
                    title: "View USUI's built in modules",
                    event: moduleTest
                }
            ],
        });
        oiContainer.style.height = "auto";
        oiContainer.style.width = "auto";
        oiContainer.style.cssText += " width: 90%;height:90%;"

        const errContent = document.createElement("div");
        errContent.classList.add("USUI_popupcontent");
        errContent.style.cssText =
            "padding: 0;display: flex;flex-direction: row; height: calc(100% - 25.5px);";
        errContent.style.cssText +=
            "min-width: 4px; min-height: 4px;max-width:100%;max-height:100%;";

        const iframe = document.createElement("iframe");
        iframe.style.cssText = "flex:1;border:none;width:100%;height:100%";

        if (params.html && !params.url) {
            const blob = new Blob([params.html], { type: "text/html" });
            const blobURL = URL.createObjectURL(blob);
            iframe.src = blobURL;
        } else {
            iframe.src = params.url;
        };
        errContent.appendChild(iframe);

        oiContainer.appendChild(errContent);
        document.body.appendChild(oiContainer);
    }
    
    function USUIalert(message = "",params = {
        titletext: "Alert",
        usehtml: false,
    }) {
        const alertContainer = USUI.createPopup({
            stay: false, 
            position: ["6%","6%"],
            id: "alertmenu",
            title: params.titletext,
            buttons: [
                {
                textContent: "X",
                title: "Close"+(params.titletext.length > 0 ? " "+params.titletext+" Window": ""),
                classes: ["closebtn"],
                event: () => {
                    USUI.closeMenu(alertContainer);}
                },
            ]
        });
        alertContainer.style.height = "auto";

        const alertContent = document.createElement('div');
        alertContent.classList.add("USUI_popupcontent", "USUI_textcolor");
        alertContent.style.cssText = "padding: 5px 15px;display: block;flex-direction: column;";
        if (params.usehtml) {
            alertContent.innerHTML = message;
        } else {
            alertContent.textContent = message;
        };

        alertContainer.appendChild(alertContent);
        document.body.appendChild(alertContainer);

        alertContainer.querySelector("button").focus();
    };
    
    function moduleTest() {
        const alertContainer = USUI.createPopup({
            stay: false, 
            position: ["6%","6%"],
            id: "modeultest",
            title: "USUI Modules",
            buttons: [
                {
                textContent: "X",
                title: "Close Modules Window",
                classes: ["closebtn"],
                event: () => {
                    USUI.closeMenu(alertContainer);}
                },
            ]
        });
        alertContainer.style.height = "auto";

        const alertContent = document.createElement('div');
        alertContent.classList.add("USUI_popupcontent", "USUI_textcolor");
        alertContent.style.cssText = "padding: 15px;display: block;flex-direction: column;";

        const row1 = document.createElement("div");

        row1.appendChild(document.createTextNode("Color Input: "));

        const exampleRGB = USUI.modules.iRGB({red:100,green:255,blue:0});
        exampleRGB.addEventListener('input',(e)=>{
            console.log(e.target.dataset.value);
        });
        row1.appendChild(exampleRGB);

        alertContent.appendChild(row1);

        alertContainer.appendChild(alertContent);
        document.body.appendChild(alertContainer);

        alertContainer.querySelector("button").focus();
    };
    </script>
</body>
</html>